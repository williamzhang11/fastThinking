# 如何避免缓存雪崩问题

场景：
	缓存如果挂了，或其他原因无法继续提供服务，所有请求全部达到DB中
	
	这样导致DB负载过大，挂掉
	
方案：

方案1：缓存高可用
	
	使用缓存的集群模式，一个缓存服务挂掉不至于整个服务无法提供。
	
	如使用redis，可以使用redis sentinel或redis cluster实现高可用
	
方案2：本地缓存

	引入本地缓存，即使分布式缓存挂了，也可以将DB查询到的结果缓存到本地，避免后续请求全部达到DB中。
	
	如Ehcache,Guava Cache实现本地缓存
	
方案3：请求DB限流

	通过限制DB的每秒请求数，避免把DB也打挂了，
	
好处：

1.有部分用户还可以使用

2.缓存恢复后，系统立即恢复，无需处理DB挂掉的情况

被限流的请求，最好有相应的处理，走服务降级

可以使用GuavaRateLimiter，Sentinel实现限流功能
	
方案4：服务降级

如果请求被限流，或请求DB超时，可以服务降级，提供一些默认的值，或友情提示，甚至空白值也行

可以使用Hystrix,Sentinel实现限流功能
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	